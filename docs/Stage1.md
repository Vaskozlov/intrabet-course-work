### 1. Подробное текстовое описание предметной области

Предметная область курсовой работы — букмекерская контора, специализирующаяся на ставках на университетские события. В контексте университета ИТМО это подразумевает фокус на мероприятиях, связанных с академической, спортивной и культурной жизнью студентов, преподавателей и сотрудников. Университетские события могут включать спортивные соревнования (например, матчи по футболу, волейболу или киберспорту между факультетами), академические олимпиады (например, хакатоны, научные конференции или конкурсы проектов), культурные мероприятия (фестивали, концерты или выборы в студенческий совет) и другие внутренние события (например, прогнозы на результаты сессий, количество отчисленных студентов или популярность курсов).

Букмекерская контора в этой области функционирует как платформа для размещения ставок, где пользователи (студенты, преподаватели, выпускники) могут предсказывать исходы событий и получать виртуальные или реальные награды (в учебных целях — виртуальные баллы или сертификаты). Основные элементы предметной области:

- **События**: Центральный объект. Каждое событие имеет атрибуты, такие как название, дата, время, участники (команды, индивидуумы), возможные исходы (победа одной стороны, ничья, конкретный счет) и коэффициенты ставок, рассчитываемые на основе вероятностей.
  
- **Пользователи**: Разделены на роли — обычные пользователи (ставщики), администраторы (модераторы событий) и возможно модераторы (для проверки ставок). Пользователи регистрируются, авторизуются, пополняют баланс (виртуальный) и размещают ставки.

- **Ставки**: Действия пользователей по прогнозированию исходов. Ставка включает сумму, выбранный исход, коэффициент и потенциальный выигрыш. После завершения события ставки рассчитываются автоматически.

- **Коэффициенты и расчеты**: Коэффициенты определяются администратором или алгоритмом на основе статистики. Расчет выигрышей: выигрыш = ставка * коэффициент (минус комиссия, если применимо).

- **Мониторинг и аналитика**: Система отслеживает историю ставок, результаты событий, статистику пользователей (рейтинги, балансы).

Предметная область ориентирована на университетскую среду, чтобы стимулировать вовлеченность в кампусную жизнь, развивать навыки анализа и прогнозирования, но без реальных финансовых рисков (в учебном проекте). Это отличает ее от коммерческих букмекерских контор, где акцент на азартных играх с реальными деньгами.

### 2. Зачем нужна информационная система для представленной предметной области, какие задачи она позволит решить

Информационная система (ИС) для букмекерской конторы на университетские события необходима для автоматизации процессов, которые в ручном режиме (например, через Google Forms или чаты) были бы неэффективными, подверженными ошибкам и ограниченными по масштабу. В университете ИТМО, где тысячи студентов участвуют в событиях, ручное управление ставками привело бы к хаосу: задержкам в расчетах, потере данных, низкой вовлеченности и упущенной выгоде.

**Цели ИС**:
- Повысить вовлеченность сообщества: Система сделает ставки доступными и интересными, мотивируя студентов следить за университетскими событиями.
- Обеспечить прозрачность и справедливость: Автоматический расчет исключает субъективность.
- Собрать данные для анализа: Для улучшения организации событий в будущем.

**Задачи, которые решает ИС**:
- Автоматизация создания и управления событиями: Администраторы быстро добавляют события, устанавливают коэффициенты.
- Упрощение размещения ставок: Пользователи видят список событий, выбирают исходы, отслеживают баланс в реальном времени.
- Обработка результатов: Автоматический расчет выигрышей после ввода исходов события.
- Безопасность данных: Защита личной информации пользователей и предотвращение мошенничества.
- Аналитика: Генерация отчетов о популярности событий, статистике ставок.
- Масштабируемость: Поддержка роста числа пользователей без потери производительности.

В итоге, ИС превратит разрозненные университетские активности в единую экосистему, способствуя социализации и развитию навыков.

### 3. Функциональные и нефункциональные требования к разрабатываемой информационной системе

#### Функциональные требования
Функциональные требования описывают, что система должна делать. Они сгруппированы по модулям.

- **Модуль аутентификации и пользователей**:
  - Регистрация новых пользователей (логин, пароль, email, роль).
  - Авторизация (логин/пароль, возможно OAuth для интеграции с университетскими аккаунтами).
  - Просмотр и редактирование профиля (баланс, история ставок).
  - Восстановление пароля.

- **Модуль событий**:
  - Создание событий администратором (название, дата, исходы, коэффициенты).
  - Просмотр списка событий (фильтры по дате, типу).
  - Редактирование/удаление событий (только до начала).
  - Ввод результатов события администратором.

- **Модуль ставок**:
  - Размещение ставки (выбор события, исхода, суммы).
  - Просмотр активных и завершенных ставок.
  - Автоматический расчет выигрышей после завершения события.
  - Пополнение/вывод баланса (виртуального).

- **Модуль аналитики**:
  - Генерация отчетов по ставкам, событиям.
  - Рейтинг пользователей по выигрышам.

- **Модуль администрирования**:
  - Управление пользователями (блокировка, роли).
  - Мониторинг системы (логи).

#### Нефункциональные требования
Нефункциональные требования касаются качеств системы.

- **Производительность**: Время отклика < 2 сек на запросы; поддержка до 1000 одновременных пользователей.
- **Надежность**: Доступность 99%; автоматическое резервное копирование БД ежедневно.
- **Безопасность**: Шифрование паролей (bcrypt); защита от SQL-инъекций; HTTPS; ролевая модель доступа (RBAC).
- **Масштабируемость**: Возможность горизонтального масштабирования (для сервера helios).
- **Usability**: Поддержка телефонов, планшетов и компьютеров.
- **Совместимость**: Работает в браузерах Chrome, Firefox; интеграция с PostgreSQL.
- **Поддержка**: Логирование ошибок; документация API.

### 4. Модели основных прецедентов и их описание

- **Прецедент "Регистрация пользователя"**:
  - Актер: Гость (неавторизованный пользователь).
  - Предусловия: Пользователь не авторизован; система доступна.
  - Основной поток: 1. Гость переходит на страницу регистрации. 2. Вводит данные: логин, пароль, email, возможно, ФИО для университетского контекста. 3. Frontend валидирует данные (например, проверка на уникальность логина через API-запрос). 4. Backend сохраняет пользователя в БД. 5. Автоматическая авторизация с выдачей JWT-токена.
  - Альтернативный поток: Если email уже используется — отобразить ошибку и предложить восстановление.
  - Исключительный поток: Ошибка соединения с БД — логгирование и сообщение "Сервер недоступен".
  - Постусловия: Новый пользователь создан, баланс инициализирован на 100 виртуальных единиц (для тестовых ставок), сессия открыта.
  - Расширения: Подтверждение email через отправку ссылки.

- **Прецедент "Авторизация пользователя"**:
  - Актер: Гость.
  - Предусловия: Пользователь зарегистрирован, но не авторизован.
  - Основной поток: 1. Гость вводит логин и пароль на форме авторизации. 2. Frontend отправляет запрос на backend. 3. Backend проверяет credentials в БД, генерирует JWT-токен при успехе. 4. Frontend сохраняет токен в localStorage и перенаправляет на главную страницу.
  - Альтернативный поток: Восстановление пароля — ссылка на email для сброса.
  - Исключительный поток: Неправильные credentials — сообщение "Неверный логин/пароль", лимит попыток (для защиты от brute-force).
  - Постусловия: Пользователь авторизован, доступны персонализированные функции (баланс, ставки).
  - Расширения: Авторизация через университетский аккаунт (OAuth, если интегрировать с ИТМО-системами).

- **Прецедент "Создание события"**:
  - Актер: Администратор.
  - Предусловия: Авторизован как admin; JWT-токен валиден.
  - Основной поток: 1. Admin открывает форму создания (с полями: название, дата, время, тип события — спорт/академия/культура, участники, возможные исходы в виде списка опций). 2. Ввод коэффициентов (ручной или алгоритмический расчет на backend). 3. Frontend отправляет данные на API (/events/create). 4. Backend валидирует (дата в будущем), сохраняет в таблицу Events (PostgreSQL). 5. Уведомление о создании (опционально, push).
  - Постусловия: Событие добавлено, visible для пользователей; лог в БД.
  - Расширения: Добавление медиа (фото события).

- **Прецедент "Просмотр списка событий"**:
  - Актер: Пользователь (или гость для публичных событий).
  - Предусловия: Система доступна; для персонализации — авторизован.
  - Основной поток: 1. Пользователь открывает страницу событий (страница с таблицей или карточками). 2. Frontend запрашивает список через API (/events/list?filter=date&type). 3. Backend извлекает данные из БД, фильтрует (активные/завершенные). 4. Отображение: название, дата, коэффициенты, статус.
  - Альтернативный поток: Фильтрация по типу (спорт/академия) или поиск по названию.
  - Исключительный поток: Нет событий — сообщение "Событий не найдено".
  - Постусловия: Список отображен; пользователь может перейти к деталям события.
  - Расширения: Пагинация для большого количества событий.

- **Прецедент "Размещение ставки"**:
  - Актер: Пользователь.
  - Предусловия: Авторизован; событие активно (не завершено); баланс >= сумма ставки.
  - Основной поток: 1. Пользователь выбирает событие и исход на детальной странице. 2. Ввод суммы (валидация на frontend). 3. API-запрос (/bets/place). 4. Backend проверяет баланс, сохраняет в таблицу Bets. 5. Подтверждение с расчетом потенциального выигрыша.
  - Альтернативный поток: Множественные ставки на одно событие (лимит по правилам).
  - Исключительный поток: Событие закрыто для ставок — ошибка.
  - Постусловия: Ставка записана; баланс обновлен; уведомление о ставке.
  - Расширения: Парные ставки (комбо на несколько событий) для углубления геймификации.

- **Прецедент "Пополнение баланса"**:
  - Актер: Пользователь.
  - Предусловия: Авторизован; виртуальный баланс (в учебной системе — через админ или бонусы).
  - Основной поток: 1. Пользователь открывает профиль. 2. Выбирает "Пополнить" и вводит сумму (симуляция, без реальных платежей). 3. API (/balance/deposit). 4. Backend обновляет баланс в БД.
  - Альтернативный поток: Бонус за регистрацию или активность — автоматическое начисление.
  - Исключительный поток: Отрицательная сумма — ошибка.
  - Постусловия: Баланс увеличен; лог транзакции.
  - Расширения: Интеграция с виртуальными наградами за университетские достижения.

- **Прецедент "Просмотр истории ставок"**:
  - Актер: Пользователь.
  - Предусловия: Авторизован.
  - Основной поток: 1. Переход в раздел "Мои ставки". 2. API (/bets/history?userId). 3. Backend извлекает из Bets. 4. Отображение: событие, сумма, исход, статус (выигрыш/проигрыш).
  - Альтернативный поток: Фильтрация по дате или статусу.
  - Исключительный поток: Нет ставок — пустой список.
  - Постусловия: История отображена; возможно, экспорт в CSV.
  - Расширения: Анализ статистики (процент выигрышей).

- **Прецедент "Расчет результатов"**:
  - Актер: Администратор.
  - Предусловия: Событие завершено; исход известен.
  - Основной поток: 1. Admin выбирает событие. 2. Вводит фактический исход (выбирает события из списка вариантов). 3. API (/events/calculate). 4. Backend: query Bets, расчет выигрышей, транзакции в БД.
  - Альтернативный поток: Никакой из вариантов не произошел (пользователям возвращаются средства).
  - Исключительный поток: Нет ставок — просто закрытие события.
  - Постусловия: Ставки обновлены; уведомления пользователям о выигрышах.
  - Расширения: Автоматический расчет по API от внешних источников (если интегрировать).

- **Прецедент "Редактирование события"**:
  - Актер: Администратор.
  - Предусловия: Авторизован; событие существует и не началось.
  - Основной поток: 1. Выбор события. 2. Редактирование полей (дата, место, тип). 3. API (/events/update). 4. Backend обновляет в БД.
  - Постусловия: Событие обновлено.
  - Расширения: Версионный контроль изменений.

- **Прецедент "Управление пользователями (блокировка)"**:
  - Актер: Администратор.
  - Предусловия: Авторизован.
  - Основной поток: 1. Просмотр списка пользователей (API /users/list). 2. Выбор пользователя. 3. Установка статуса "blocked". 4. Update в БД.
  - Альтернативный поток: Разблокировка.
  - Исключительный поток: Самоблокировка — запрещено.
  - Постусловия: Пользователь заблокирован; ставки аннулированы если нужно.
  - Расширения: Причины блокировки (лог в БД).

- **Прецедент "Генерация отчета по событиям"**:
  - Актер: Администратор.
  - Предусловия: Авторизован.
  - Основной поток: 1. Выбор параметров (дата, тип). 2. API (/reports/generate). 3. Backend агрегирует данные. 4. Отображение в таблице или экспорт PDF (Angular).
  - Альтернативный поток: Отчет по пользователям.
  - Исключительный поток: Нет данных — пустой отчет.
  - Постусловия: Отчет сгенерирован.
  - Расширения: Графики.

### 5. Предлагаемая архитектура будущей системы

Архитектура — клиент-серверная, многоуровневая (MVC), с учетом демонстрации на сервере helios (вероятно, виртуальная машина или хостинг ИТМО с ограниченными ресурсами, так что акцент на легковесность).

- **Клиентская часть (Frontend)**: Angular — одностраничное приложение (SPA) для динамического интерфейса. Компоненты: страницы аутентификации, событий, ставок. Взаимодействие с backend через REST API (HTTP requests с Angular HttpClient). Актуализация информации при помощи WebSocket.

- **Серверная часть (Backend)**: Java Jakarta EE — для бизнес-логики. Используем EJB для сессионных бинов (управление транзакциями), JPA (Hibernate) для ORM с PostgreSQL. Сервер приложений — WildFly или GlassFish. RESTful сервисы с JAX-RS.

- **База данных**: PostgreSQL — реляционная БД. Таблицы: Users (id, login, password_hash, balance, role), Events (id, name, date, outcomes_json), Bets (id, user_id, event_id, amount, outcome, status).

- **Интеграция**: Frontend <-> Backend via REST API (JSON). Безопасность: JWT-токены для аутентификации.

- **Развертывание на helios**: Docker-контейнеры для backend и DB (для изоляции). Nginx как reverse-proxy для frontend. Мониторинг: встроенные логи Jakarta EE.

**Согласованные технологии**: Backend — Java Jakarta EE (JAX-RS, JPA); Frontend — Angular; DB — PostgreSQL. Дополнительно: Gradle для сборки, Git для версионного контроля.
